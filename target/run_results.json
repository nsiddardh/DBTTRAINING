{"results": [{"node": {"raw_sql": "{{ config(materialized='view') }}\r\n\r\n{%- set yaml_metadata -%}\r\n\r\nsource_model: \"i_tbc_hme_timer_detail\"\r\ndup_method: \"first\"\r\nkey_columns: \"DW_STOREID,DW_TRANS_DAY,TRANS_TIME_TXT\"\r\nderived_columns:\r\n    DW_STOREID: 'DW_STOREID'\r\n    DW_BUSI_DAY: 'DW_BUSI_DAY'\r\n    DW_TRANS_DAY: 'DW_TRANS_DAY'\r\n    DW_DAYPART: 'DW_DAYPART'\r\n    OPEN_TIME_TXT: 'OPEN_TIME_TXT'\r\n    CLOSE_TIME_TXT: 'CLOSE_TIME_TXT'\r\n    TRANS_TIME_TXT: 'TRANS_TIME_TXT'\r\n    GREET_DELAY_DUR_SEC: 'GREET_DELAY_DUR_SEC'\r\n    MENU_BOARD_DELAY_DUR_SEC: 'MENU_BOARD_DELAY_DUR_SEC'\r\n    QUEUE_DUR_SEC: 'QUEUE_DUR_SEC'\r\n    CASHIER_WINDOW_DUR_SEC: 'CASHIER_WINDOW_DUR_SEC'\r\n    BOOTH_QUEUE_DUR_SEC: 'BOOTH_QUEUE_DUR_SEC'\r\n    SERV_WINDOW_QUEUE_DUR_SEC: 'SERV_WINDOW_QUEUE_DUR_SEC'\r\n    TOT_BOOTH_DUR_SEC: 'TOT_BOOTH_DUR_SEC'\r\n    WAIT_AREA_DUR_SEC: 'WAIT_AREA_DUR_SEC'\r\n    TOT_SOS_DUR_SECONDS: \"TOT_SOS_DUR_SECONDS\"\r\n    DRIVE_THRU_LANE_NBR: \"DRIVE_THRU_LANE_NBR\"\r\n    TBC_LANE: \"TBC_LANE\"\r\n    CREATE_ID: \"CREATE_ID\"\r\n    CREATE_TMSTMP: 'CREATE_TMSTMP'\r\n    UPDT_ID: 'UPDT_ID'\r\n    UPDT_TMSTMP: 'UPDT_TMSTMP'\r\n\r\n\r\n        \r\n{% endset %}\r\n\r\n{% set metadata_dict = fromyaml(yaml_metadata) %}\r\n\r\n\r\n{{ PxRemDup_macro(metadata_dict) }}", "compiled": true, "database": "TESTDBT", "schema": "DBT_SNAMBURI", "fqn": ["dbttraining", "dsstage_models", "PxRemDup"], "unique_id": "model.dbttraining.PxRemDup", "package_name": "dbttraining", "root_path": "E:\\Training\\DBT\\DBTTRAINING", "path": "dsstage_models\\PxRemDup.sql", "original_file_path": "models\\dsstage_models\\PxRemDup.sql", "name": "PxRemDup", "resource_type": "model", "alias": "PxRemDup", "checksum": {"name": "sha256", "checksum": "afcd30873053283a540968fb3350ae640f8088ae8a5a782ef725bd62d18f746d"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["i_tbc_hme_timer_detail"]], "sources": [], "depends_on": {"macros": ["macro.dbttraining.PxRemDup_macro", "macro.dbt_snowflake.set_query_tag", "macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["model.dbttraining.i_tbc_hme_timer_detail"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target\\run\\dbttraining\\models\\dsstage_models\\PxRemDup.sql", "deferred": false, "compiled_sql": "\n\n\n\n\n\n\n\n\n\n\n\nwith source_data as (\nSELECT  DISTINCT DW_STOREID AS DW_STOREID,\n    DW_BUSI_DAY AS DW_BUSI_DAY,\n    DW_TRANS_DAY AS DW_TRANS_DAY,\n    DW_DAYPART AS DW_DAYPART,\n    OPEN_TIME_TXT AS OPEN_TIME_TXT,\n    CLOSE_TIME_TXT AS CLOSE_TIME_TXT,\n    TRANS_TIME_TXT AS TRANS_TIME_TXT,\n    GREET_DELAY_DUR_SEC AS GREET_DELAY_DUR_SEC,\n    MENU_BOARD_DELAY_DUR_SEC AS MENU_BOARD_DELAY_DUR_SEC,\n    QUEUE_DUR_SEC AS QUEUE_DUR_SEC,\n    CASHIER_WINDOW_DUR_SEC AS CASHIER_WINDOW_DUR_SEC,\n    BOOTH_QUEUE_DUR_SEC AS BOOTH_QUEUE_DUR_SEC,\n    SERV_WINDOW_QUEUE_DUR_SEC AS SERV_WINDOW_QUEUE_DUR_SEC,\n    TOT_BOOTH_DUR_SEC AS TOT_BOOTH_DUR_SEC,\n    WAIT_AREA_DUR_SEC AS WAIT_AREA_DUR_SEC,\n    TOT_SOS_DUR_SECONDS AS TOT_SOS_DUR_SECONDS,\n    DRIVE_THRU_LANE_NBR AS DRIVE_THRU_LANE_NBR,\n    TBC_LANE AS TBC_LANE,\n    CREATE_ID AS CREATE_ID,\n    CREATE_TMSTMP AS CREATE_TMSTMP,\n    UPDT_ID AS UPDT_ID,\n    UPDT_TMSTMP AS UPDT_TMSTMP\n, ROW_NUMBER() OVER (PARTITION BY DW_STOREID,DW_TRANS_DAY,TRANS_TIME_TXT order by DW_STOREID,DW_TRANS_DAY,TRANS_TIME_TXT) AS rn\nFROM i_tbc_hme_timer_detail as XFM_HME\n)\n\nselect * from source_data WHERE rn = 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\n\n\n\n\n\n\n\nwith source_data as (\nSELECT  DISTINCT DW_STOREID AS DW_STOREID,\n    DW_BUSI_DAY AS DW_BUSI_DAY,\n    DW_TRANS_DAY AS DW_TRANS_DAY,\n    DW_DAYPART AS DW_DAYPART,\n    OPEN_TIME_TXT AS OPEN_TIME_TXT,\n    CLOSE_TIME_TXT AS CLOSE_TIME_TXT,\n    TRANS_TIME_TXT AS TRANS_TIME_TXT,\n    GREET_DELAY_DUR_SEC AS GREET_DELAY_DUR_SEC,\n    MENU_BOARD_DELAY_DUR_SEC AS MENU_BOARD_DELAY_DUR_SEC,\n    QUEUE_DUR_SEC AS QUEUE_DUR_SEC,\n    CASHIER_WINDOW_DUR_SEC AS CASHIER_WINDOW_DUR_SEC,\n    BOOTH_QUEUE_DUR_SEC AS BOOTH_QUEUE_DUR_SEC,\n    SERV_WINDOW_QUEUE_DUR_SEC AS SERV_WINDOW_QUEUE_DUR_SEC,\n    TOT_BOOTH_DUR_SEC AS TOT_BOOTH_DUR_SEC,\n    WAIT_AREA_DUR_SEC AS WAIT_AREA_DUR_SEC,\n    TOT_SOS_DUR_SECONDS AS TOT_SOS_DUR_SECONDS,\n    DRIVE_THRU_LANE_NBR AS DRIVE_THRU_LANE_NBR,\n    TBC_LANE AS TBC_LANE,\n    CREATE_ID AS CREATE_ID,\n    CREATE_TMSTMP AS CREATE_TMSTMP,\n    UPDT_ID AS UPDT_ID,\n    UPDT_TMSTMP AS UPDT_TMSTMP\n, ROW_NUMBER() OVER (PARTITION BY DW_STOREID,DW_TRANS_DAY,TRANS_TIME_TXT order by DW_STOREID,DW_TRANS_DAY,TRANS_TIME_TXT) AS rn\nFROM i_tbc_hme_timer_detail as XFM_HME\n)\n\nselect * from source_data WHERE rn = 1\n\n\n"}, "error": null, "status": "SUCCESS 1", "execution_time": 5.631549119949341, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-05-16T16:13:56.177410Z", "completed_at": "2021-05-16T16:13:59.077795Z"}, {"name": "execute", "started_at": "2021-05-16T16:13:59.078791Z", "completed_at": "2021-05-16T16:14:00.862229Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2021-05-16T16:14:05.480733Z", "elapsed_time": 20.333794116973877}