{"results": [{"node": {"raw_sql": "{{ config(materialized='view') }}\r\n\r\n\r\n\r\n{%- set yaml_metadata -%}\r\n\r\nbefore_model: \"emp_src\"\r\nafter_model: \"emp1_src\"\r\n\r\nkey_columns: [\"empid\"]\r\nchange_columns: [\"empname\",\"deptid\"]\r\n\r\nbefore_columns: \r\n    empid: 'empid'\r\n    empname: 'empname'\r\n    deptid: 'deptid'\r\nafter_columns: \r\n    empid: 'empid'\r\n    empname: 'empname'\r\n    deptid: 'deptid'\r\nderived_columns:\r\n    empid: 'empid'\r\n    empname: 'empname'\r\n    deptid: 'deptid'\r\n\r\n{% endset %}\r\n\r\n{% set metadata_dict = fromyaml(yaml_metadata) %}\r\n\r\n{{ PxChangeCapture_macro(metadata_dict) }}", "compiled": true, "database": "TESTDBT", "schema": "DBT_SNAMBURI", "fqn": ["dbttraining", "dsstage_models", "PxChangeCapture"], "unique_id": "model.dbttraining.PxChangeCapture", "package_name": "dbttraining", "root_path": "E:\\Training\\DBT\\DBTTRAINING", "path": "dsstage_models\\PxChangeCapture.sql", "original_file_path": "models\\dsstage_models\\PxChangeCapture.sql", "name": "PxChangeCapture", "resource_type": "model", "alias": "PxChangeCapture", "checksum": {"name": "sha256", "checksum": "170832473acb216fdc22ed03b374174bdd5d9f3dacb4696b4c669ba17da6e5a0"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["emp1_src"], ["emp1_src"], ["emp1_src"], ["emp1_src"]], "sources": [], "depends_on": {"macros": ["macro.dbttraining.PxChangeCapture_macro", "macro.dbt_snowflake.set_query_tag", "macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["model.dbttraining.emp1_src", "model.dbttraining.emp1_src", "model.dbttraining.emp1_src", "model.dbttraining.emp1_src"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target\\run\\dbttraining\\models\\dsstage_models\\PxChangeCapture.sql", "deferred": false, "compiled_sql": "\n\n\n\nSELECT empid AS empid,\n    empname AS empname,\n    deptid AS deptid , 0 AS CHNAGE_CODE\nFROM   emp1_src where    empid||empname||deptid     in     (\n                        select empid||empname||deptid\n                            from emp_src as emp_src \n                        \n                    )\n\nUNION ALL\n\nSELECT empid AS empid,\n    empname AS empname,\n    deptid AS deptid , 1 AS CHNAGE_CODE\nFROM   emp1_src where    empid not  in     (\n                        select empid\n                            from emp_src as emp_src \n                        \n                    )\n\nUNION ALL\n\nSELECT empid AS empid,\n    empname AS empname,\n    deptid AS deptid , 2 AS CHNAGE_CODE\nFROM   emp_src where    empid not  in     (\n                        select empid\n                            from emp1_src as emp1_src \n                        \n                    )\n\nUNION ALL\n\nSELECT empid AS empid,\n    empname AS empname,\n    deptid AS deptid , 3 AS CHNAGE_CODE\nFROM   emp1_src \nwhere    MD5(empid) in   (select   after_key_col from \n(select MD5(empid) as after_key_col, MD5(empname||deptid) as after_change_col_list from emp1_src )a,\n(select MD5(empid) as before_key_col, MD5(empname||deptid) as before_change_col_list from emp_src)b\n where a.after_key_col = b.before_key_col and a.after_change_col_list != b.before_change_col_list)                        \n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nSELECT empid AS empid,\n    empname AS empname,\n    deptid AS deptid , 0 AS CHNAGE_CODE\nFROM   emp1_src where    empid||empname||deptid     in     (\n                        select empid||empname||deptid\n                            from emp_src as emp_src \n                        \n                    )\n\nUNION ALL\n\nSELECT empid AS empid,\n    empname AS empname,\n    deptid AS deptid , 1 AS CHNAGE_CODE\nFROM   emp1_src where    empid not  in     (\n                        select empid\n                            from emp_src as emp_src \n                        \n                    )\n\nUNION ALL\n\nSELECT empid AS empid,\n    empname AS empname,\n    deptid AS deptid , 2 AS CHNAGE_CODE\nFROM   emp_src where    empid not  in     (\n                        select empid\n                            from emp1_src as emp1_src \n                        \n                    )\n\nUNION ALL\n\nSELECT empid AS empid,\n    empname AS empname,\n    deptid AS deptid , 3 AS CHNAGE_CODE\nFROM   emp1_src \nwhere    MD5(empid) in   (select   after_key_col from \n(select MD5(empid) as after_key_col, MD5(empname||deptid) as after_change_col_list from emp1_src )a,\n(select MD5(empid) as before_key_col, MD5(empname||deptid) as before_change_col_list from emp_src)b\n where a.after_key_col = b.before_key_col and a.after_change_col_list != b.before_change_col_list)                        \n\n\n"}, "error": null, "status": "SUCCESS 1", "execution_time": 3.882167339324951, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-08-27T13:21:40.221586Z", "completed_at": "2021-08-27T13:21:42.804620Z"}, {"name": "execute", "started_at": "2021-08-27T13:21:42.812581Z", "completed_at": "2021-08-27T13:21:43.803541Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2021-08-27T13:22:06.824363Z", "elapsed_time": 54.20226216316223}