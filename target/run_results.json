{"results": [{"node": {"raw_sql": "{{ config(materialized='view') }}\r\n\r\n\r\n{%- set yaml_metadata -%}\r\n\r\nsource_model: \"\"\r\nlkp_models: [\"lkp_busi_dt\",\"odbc_time_day_dim\",\"ODBC_TIME_DAY_PART\"]\r\nlkp_conditions: [\"lkp_busi_dt.BUSINESS_DATE=odbc_time_day_dim.busidaydt\",\"lkp_busi_dt.OPEN_TIME=ODBC_TIME_DAY_PART.MINITUTM\"]\r\npartition_by_field: [\"BUSIDAYDT\",\"MINITUTM\"]\r\nlkp_field: [\"DW_DAY,DW_FISCALPERIOD\",\"DW_MINITUE,DW_DAY\"]\r\nderived_columns:\r\n    DW_MINITUE: \"ODBC_TIME_DAY_PART.DW_MINITUE\"\r\n    DW_BUSI_DAY: \"odbc_time_day_dim.DW_DAY\"\r\n    STORE_ID: \"lkp_busi_dt.STORE_ID\"\r\n    DW_STOREID: \"lkp_busi_dt.DW_STOREID\"\r\n    BUSINESS_DATE: \"lkp_busi_dt.BUSINESS_DATE\"\r\n    OPEN_TIME: \"lkp_busi_dt.OPEN_TIME\"\r\n    CLOSE_TIME: \"lkp_busi_dt.CLOSE_TIME\"\r\n    TRANSACTION_DATE: \"lkp_busi_dt.TRANSACTION_DATE\"\r\n    TRANS_DATE_TXT: \"lkp_busi_dt.TRANS_DATE_TXT\"\r\n    TRANSACTION_TIME: \"lkp_busi_dt.TRANSACTION_TIME\"\r\n    GREET_DELAY: \"lkp_busi_dt.GREET_DELAY\"\r\n    MENU_BOARD_DURATION: \"lkp_busi_dt.MENU_BOARD_DURATION\"\r\n    QUEUE_DURATION: \"lkp_busi_dt.QUEUE_DURATION\"\r\n    CASHIER_WINDOW_DURATION: \"lkp_busi_dt.CASHIER_WINDOW_DURATION\"\r\n    BOOTH_QUEUE_DURATION: \"lkp_trans_dt.BOOTH_QUEUE_DURATION\"\r\n    SERVICE_WINDOW_DURATION: \"lkp_busi_dt.SERVICE_WINDOW_DURATION\"\r\n    TOTAL_BOOTH_DURATION: \"lkp_busi_dt.TOTAL_BOOTH_DURATION\"\r\n    WAITING_AREA_DURATION: \"lkp_busi_dt.WAITING_AREA_DURATION\"\r\n    TRANSACTION_TIME_LKP: \"lkp_busi_dt.TRANSACTION_TIME_LKP\"\r\n    TOTAL_SPEED_OF_SERVICE_DURATION: \"lkp_busi_dt.TOTAL_SPEED_OF_SERVICE_DURATION\"\r\n    LANE_NUMBER: \"lkp_busi_dt.LANE_NUMBER\"\r\n    TBC_LANE: \"lkp_busi_dt.TBC_LANE\"\r\n\r\n{% endset %}\r\n\r\n\r\n{% set metadata_dict = fromyaml(yaml_metadata) %}\r\n\r\n{{ PxLookup_macro(metadata_dict) }}", "compiled": true, "database": "TESTDBT", "schema": "DBT_SNAMBURI", "fqn": ["dbttraining", "dsstage_models", "PxLookup_multiple_lkp"], "unique_id": "model.dbttraining.PxLookup_multiple_lkp", "package_name": "dbttraining", "root_path": "E:\\Training\\DBT\\DBTTRAINING", "path": "dsstage_models\\PxLookup_multiple_lkp.sql", "original_file_path": "models\\dsstage_models\\PxLookup_multiple_lkp.sql", "name": "PxLookup_multiple_lkp", "resource_type": "model", "alias": "PxLookup_multiple_lkp", "checksum": {"name": "sha256", "checksum": "4857fb82c1436d4c5f8d21ec15ee0523c8ddc09473a85c211f4158714cc1b07f"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["lkp_busi_dt"]], "sources": [], "depends_on": {"macros": ["macro.dbttraining.PxLookup_macro"], "nodes": ["model.dbttraining.lkp_busi_dt"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target\\compiled\\dbttraining\\models\\dsstage_models\\PxLookup_multiple_lkp.sql", "deferred": false, "compiled_sql": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nselect ODBC_TIME_DAY_PART.DW_MINITUE AS DW_MINITUE,\n    odbc_time_day_dim.DW_DAY AS DW_BUSI_DAY,\n    lkp_busi_dt.STORE_ID AS STORE_ID,\n    lkp_busi_dt.DW_STOREID AS DW_STOREID,\n    lkp_busi_dt.BUSINESS_DATE AS BUSINESS_DATE,\n    lkp_busi_dt.OPEN_TIME AS OPEN_TIME,\n    lkp_busi_dt.CLOSE_TIME AS CLOSE_TIME,\n    lkp_busi_dt.TRANSACTION_DATE AS TRANSACTION_DATE,\n    lkp_busi_dt.TRANS_DATE_TXT AS TRANS_DATE_TXT,\n    lkp_busi_dt.TRANSACTION_TIME AS TRANSACTION_TIME,\n    lkp_busi_dt.GREET_DELAY AS GREET_DELAY,\n    lkp_busi_dt.MENU_BOARD_DURATION AS MENU_BOARD_DURATION,\n    lkp_busi_dt.QUEUE_DURATION AS QUEUE_DURATION,\n    lkp_busi_dt.CASHIER_WINDOW_DURATION AS CASHIER_WINDOW_DURATION,\n    lkp_trans_dt.BOOTH_QUEUE_DURATION AS BOOTH_QUEUE_DURATION,\n    lkp_busi_dt.SERVICE_WINDOW_DURATION AS SERVICE_WINDOW_DURATION,\n    lkp_busi_dt.TOTAL_BOOTH_DURATION AS TOTAL_BOOTH_DURATION,\n    lkp_busi_dt.WAITING_AREA_DURATION AS WAITING_AREA_DURATION,\n    lkp_busi_dt.TRANSACTION_TIME_LKP AS TRANSACTION_TIME_LKP,\n    lkp_busi_dt.TOTAL_SPEED_OF_SERVICE_DURATION AS TOTAL_SPEED_OF_SERVICE_DURATION,\n    lkp_busi_dt.LANE_NUMBER AS LANE_NUMBER,\n    lkp_busi_dt.TBC_LANE AS TBC_LANE \nfrom lkp_busi_dt as lkp_busi_dt  \n\n\n \n  \n  \n     left outer join (select distinct BUSIDAYDT , \n     \n         \n            \n            \n               first_value(DW_DAY) over(partition by  BUSIDAYDT order by select(1) ) as DW_DAY ,\n            \n            \n            \n               first_value(DW_FISCALPERIOD) over(partition by  BUSIDAYDT order by select(1) ) as DW_FISCALPERIOD\n     from odbc_time_day_dim)  odbc_time_day_dim on \n     lkp_busi_dt.BUSINESS_DATE=odbc_time_day_dim.busidaydt\n \n  \n  \n     left outer join (select distinct MINITUTM , \n     \n         \n            \n            \n               first_value(DW_MINITUE) over(partition by  MINITUTM order by select(1) ) as DW_MINITUE ,\n            \n            \n            \n               first_value(DW_DAY) over(partition by  MINITUTM order by select(1) ) as DW_DAY\n     from ODBC_TIME_DAY_PART)  ODBC_TIME_DAY_PART on \n     lkp_busi_dt.OPEN_TIME=ODBC_TIME_DAY_PART.MINITUTM\n\n                  \n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nselect ODBC_TIME_DAY_PART.DW_MINITUE AS DW_MINITUE,\n    odbc_time_day_dim.DW_DAY AS DW_BUSI_DAY,\n    lkp_busi_dt.STORE_ID AS STORE_ID,\n    lkp_busi_dt.DW_STOREID AS DW_STOREID,\n    lkp_busi_dt.BUSINESS_DATE AS BUSINESS_DATE,\n    lkp_busi_dt.OPEN_TIME AS OPEN_TIME,\n    lkp_busi_dt.CLOSE_TIME AS CLOSE_TIME,\n    lkp_busi_dt.TRANSACTION_DATE AS TRANSACTION_DATE,\n    lkp_busi_dt.TRANS_DATE_TXT AS TRANS_DATE_TXT,\n    lkp_busi_dt.TRANSACTION_TIME AS TRANSACTION_TIME,\n    lkp_busi_dt.GREET_DELAY AS GREET_DELAY,\n    lkp_busi_dt.MENU_BOARD_DURATION AS MENU_BOARD_DURATION,\n    lkp_busi_dt.QUEUE_DURATION AS QUEUE_DURATION,\n    lkp_busi_dt.CASHIER_WINDOW_DURATION AS CASHIER_WINDOW_DURATION,\n    lkp_trans_dt.BOOTH_QUEUE_DURATION AS BOOTH_QUEUE_DURATION,\n    lkp_busi_dt.SERVICE_WINDOW_DURATION AS SERVICE_WINDOW_DURATION,\n    lkp_busi_dt.TOTAL_BOOTH_DURATION AS TOTAL_BOOTH_DURATION,\n    lkp_busi_dt.WAITING_AREA_DURATION AS WAITING_AREA_DURATION,\n    lkp_busi_dt.TRANSACTION_TIME_LKP AS TRANSACTION_TIME_LKP,\n    lkp_busi_dt.TOTAL_SPEED_OF_SERVICE_DURATION AS TOTAL_SPEED_OF_SERVICE_DURATION,\n    lkp_busi_dt.LANE_NUMBER AS LANE_NUMBER,\n    lkp_busi_dt.TBC_LANE AS TBC_LANE \nfrom lkp_busi_dt as lkp_busi_dt  \n\n\n \n  \n  \n     left outer join (select distinct BUSIDAYDT , \n     \n         \n            \n            \n               first_value(DW_DAY) over(partition by  BUSIDAYDT order by select(1) ) as DW_DAY ,\n            \n            \n            \n               first_value(DW_FISCALPERIOD) over(partition by  BUSIDAYDT order by select(1) ) as DW_FISCALPERIOD\n     from odbc_time_day_dim)  odbc_time_day_dim on \n     lkp_busi_dt.BUSINESS_DATE=odbc_time_day_dim.busidaydt\n \n  \n  \n     left outer join (select distinct MINITUTM , \n     \n         \n            \n            \n               first_value(DW_MINITUE) over(partition by  MINITUTM order by select(1) ) as DW_MINITUE ,\n            \n            \n            \n               first_value(DW_DAY) over(partition by  MINITUTM order by select(1) ) as DW_DAY\n     from ODBC_TIME_DAY_PART)  ODBC_TIME_DAY_PART on \n     lkp_busi_dt.OPEN_TIME=ODBC_TIME_DAY_PART.MINITUTM\n\n                  \n"}, "error": null, "status": null, "execution_time": 3.3143465518951416, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-04-17T15:59:39.844958Z", "completed_at": "2021-04-17T15:59:42.686642Z"}, {"name": "execute", "started_at": "2021-04-17T15:59:42.687620Z", "completed_at": "2021-04-17T15:59:42.687620Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2021-04-17T15:59:43.161302Z", "elapsed_time": 7.591643571853638}