









WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT *

    FROM TESTDBT.DBT_SNAMBURI.lkp_day_part
),

derived_columns AS (

    SELECT

    DW_STOREID AS DW_STOREID,
    DW_BUSI_DAY AS DW_BUSI_DAY,
    DW_TRANS_DAY AS DW_TRANS_DAY,
    DW_DAYPART AS DW_DAYPART,
    OPEN_TIME AS OPEN_TIME_TXT,
    CLOSE_TIME AS CLOSE_TIME_TXT,
    TRANSACTION_TIME AS TRANS_TIME_TXT,
    GREET_DELAY AS GREET_DELAY_DUR_SEC,
    MENU_BOARD_DURATION AS MENU_BOARD_DELAY_DUR_SEC,
    QUEUE_DURATION AS QUEUE_DUR_SEC,
    CASHIER_WINDOW_DURATION AS CASHIER_WINDOW_DUR_SEC,
    BOOTH_QUEUE_DURATION AS BOOTH_QUEUE_DUR_SEC,
    SERVICE_WINDOW_DURATION AS SERV_WINDOW_QUEUE_DUR_SEC,
    TOTAL_BOOTH_DURATION AS TOT_BOOTH_DUR_SEC,
    WAITING_AREA_DURATION AS WAIT_AREA_DUR_SEC,
    TOTAL_SPEED_OF_SERVICE_DURATION AS TOT_SOS_DUR_SECONDS,
    LANE_NUMBER AS DRIVE_THRU_LANE_NBRLANE_NUMBER,
    TBC_LANE AS TBC_LANE

    FROM source_data
),

columns_to_select AS (

    SELECT

    DW_STOREID,
    DW_BUSI_DAY,
    DW_TRANS_DAY,
    DW_DAYPART,
    OPEN_TIME_TXT,
    CLOSE_TIME_TXT,
    TRANS_TIME_TXT,
    GREET_DELAY_DUR_SEC,
    MENU_BOARD_DELAY_DUR_SEC,
    QUEUE_DUR_SEC,
    CASHIER_WINDOW_DUR_SEC,
    BOOTH_QUEUE_DUR_SEC,
    SERV_WINDOW_QUEUE_DUR_SEC,
    TOT_BOOTH_DUR_SEC,
    WAIT_AREA_DUR_SEC,
    TOT_SOS_DUR_SECONDS,
    DRIVE_THRU_LANE_NBRLANE_NUMBER,
    TBC_LANE

    FROM derived_columns
)

SELECT * FROM columns_to_select
)

SELECT *
FROM staging

